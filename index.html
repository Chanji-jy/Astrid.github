<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>100 Mexicanos Dijeron - Sistema Completo</title>
    <style>
        body {
            font-family: 'Arial', sans-serif;
            background-color: #0c4c8a;
            color: white;
            text-align: center;
            margin: 0;
            padding: 20px;
        }
        
        .container {
            max-width: 1000px;
            margin: 0 auto;
        }
        
        .header {
            margin-bottom: 20px;
        }
        
        .header h1 {
            color: #ffcc00;
            font-size: 36px;
            text-shadow: 2px 2px 4px #000;
            margin: 0;
        }
        
        .header p {
            color: #ffcc00;
            font-size: 16px;
            margin-top: 5px;
        }
        
        .mode-selector {
            margin: 20px 0;
        }
        
        .mode-selector button {
            background-color: #ffcc00;
            color: #003366;
            border: none;
            padding: 10px 20px;
            font-size: 18px;
            font-weight: bold;
            border-radius: 5px;
            cursor: pointer;
            margin: 0 10px;
            transition: all 0.3s ease;
        }
        
        .mode-selector button:hover {
            background-color: #ffd633;
            transform: scale(1.05);
        }
        
        .mode-selector button.active {
            background-color: #ff9900;
            box-shadow: 0 0 10px #ffcc00;
        }
        
        /* Estilos para el modo presentador */
        #presenter-mode {
            display: none;
        }
        
        .presenter-container {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
        }
        
        .game-controls {
            background-color: #003366;
            border-radius: 10px;
            padding: 15px;
            border: 2px solid #ffcc00;
        }
        
        .question-controls {
            margin-bottom: 20px;
        }
        
        select {
            padding: 10px;
            font-size: 16px;
            border-radius: 5px;
            background-color: #ffcc00;
            color: #003366;
            border: none;
            width: 90%;
            margin-bottom: 10px;
            cursor: pointer;
        }
        
        .current-question {
            background-color: #002244;
            padding: 10px;
            border-radius: 8px;
            margin-bottom: 15px;
            font-size: 18px;
            border: 1px solid #ffcc00;
            min-height: 60px;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .team-controls {
            display: flex;
            justify-content: space-around;
            margin: 10px 0;
        }
        
        .team-score {
            background-color: #002244;
            padding: 10px;
            border-radius: 5px;
            width: 45%;
            border: 1px solid #ffcc00;
        }
        
        .team-score h3 {
            margin-top: 0;
            color: #ffcc00;
        }
        
        .score-controls {
            display: flex;
            justify-content: center;
            gap: 10px;
            margin-top: 5px;
        }
        
        .score-display {
            font-size: 28px;
            font-weight: bold;
            margin: 5px 0;
        }
        
        .answer-list {
            background-color: #003366;
            border-radius: 10px;
            padding: 15px;
            border: 2px solid #ffcc00;
        }
        
        .admin-answer {
            display: flex;
            align-items: center;
            background-color: #002244;
            padding: 10px;
            border-radius: 5px;
            margin-bottom: 8px;
            border: 1px solid #ffcc00;
        }
        
        .admin-answer.revealed {
            background-color: #005599;
        }
        
        .answer-number {
            width: 25px;
            height: 25px;
            background-color: #ffcc00;
            color: #003366;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            margin-right: 10px;
            flex-shrink: 0;
        }
        
        .answer-text {
            flex-grow: 1;
            text-align: left;
            padding-left: 5px;
        }
        
        .answer-points {
            background-color: #ffcc00;
            color: #003366;
            padding: 3px 8px;
            border-radius: 5px;
            font-weight: bold;
            margin-right: 10px;
        }
        
        .reveal-btn {
            background-color: #33cc33;
            color: white;
            border: none;
            padding: 5px 10px;
            border-radius: 5px;
            cursor: pointer;
            font-weight: bold;
        }
        
        .reveal-btn:disabled {
            background-color: #88cc88;
            cursor: not-allowed;
        }
        
        .game-actions {
            display: flex;
            justify-content: space-around;
            margin-top: 15px;
        }
        
        /* Estilos para el modo proyección */
        #projection-mode {
            display: none;
        }
        
        .projection-container {
            max-width: 900px;
            margin: 0 auto;
        }
        
        .projection-question {
            background-color: #003366;
            padding: 15px;
            border-radius: 10px;
            margin-bottom: 20px;
            font-size: 28px;
            border: 3px solid #ffcc00;
            min-height: 80px;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .projection-answers {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
            margin-bottom: 20px;
        }
        
        .projection-answer {
            background-color: #0055a4;
            padding: 15px;
            border-radius: 8px;
            height: 80px;
            display: flex;
            align-items: center;
            justify-content: space-between;
            font-size: 24px;
            border: 2px solid #ffcc00;
        }
        
        .projection-answer.hidden {
            background-color: #003366;
            color: transparent;
        }
        
        .projection-answer-number {
            width: 35px;
            height: 35px;
            background-color: #ffcc00;
            color: #003366;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            margin-right: 15px;
            font-size: 20px;
        }
        
        .projection-answer-text {
            flex-grow: 1;
            text-align: left;
            padding-left: 10px;
        }
        
        .projection-answer-points {
            background-color: #ffcc00;
            color: #003366;
            padding: 5px 15px;
            border-radius: 5px;
            font-weight: bold;
            font-size: 20px;
            min-width: 40px;
        }
        
        .projection-strikes {
            display: flex;
            justify-content: center;
            margin-bottom: 20px;
            gap: 25px;
        }
        
        .projection-strike {
            font-size: 60px;
            color: #ff3333;
            opacity: 0.3;
            text-shadow: 2px 2px 4px #000;
        }
        
        .projection-strike.active {
            opacity: 1;
        }
        
        .projection-teams {
            display: flex;
            justify-content: space-around;
            margin-top: 30px;
        }
        
        .projection-team {
            background-color: #003366;
            border: 2px solid #ffcc00;
            border-radius: 10px;
            padding: 15px;
            width: 45%;
        }
        
        .projection-team h3 {
            margin-top: 0;
            color: #ffcc00;
            font-size: 24px;
        }
        
        .projection-score {
            font-size: 40px;
            font-weight: bold;
        }
        
        .wrong-answer {
            display: none;
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            font-size: 200px;
            color: #ff3333;
            text-shadow: 4px 4px 8px #000;
            z-index: 100;
        }
        
        /* Estilos para gestión de preguntas */
        #question-manager {
            display: none;
            background-color: #003366;
            border-radius: 10px;
            padding: 20px;
            border: 2px solid #ffcc00;
            max-width: 800px;
            margin: 0 auto;
        }
        
        .question-form {
            margin-bottom: 20px;
            text-align: left;
        }
        
        .question-form label {
            display: block;
            margin-bottom: 5px;
            color: #ffcc00;
        }
        
        .question-form input, .question-form textarea {
            width: 100%;
            padding: 8px;
            margin-bottom: 15px;
            border-radius: 5px;
            border: 1px solid #ffcc00;
            background-color: #002244;
            color: white;
        }
        
        .question-form textarea {
            height: 60px;
            resize: vertical;
        }
        
        .answer-inputs {
            border: 1px solid #0066cc;
            padding: 10px;
            border-radius: 5px;
            margin-bottom: 15px;
            background-color: #002244;
        }
        
        .answer-input-row {
            display: flex;
            gap: 10px;
            margin-bottom: 10px;
        }
        
        .answer-input-row input[type="text"] {
            flex-grow: 1;
        }
        
        .answer-input-row input[type="number"] {
            width: 70px;
        }
        
        .questions-list {
            text-align: left;
            margin-top: 20px;
        }
        
        .saved-question {
            background-color: #002244;
            padding: 10px;
            border-radius: 5px;
            margin-bottom: 10px;
            border: 1px solid #0066cc;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .button-small {
            padding: 5px 10px;
            font-size: 14px;
        }
        
        .button-danger {
            background-color: #ff3333;
        }
        
        /* Efectos de transición */
        .fade-in {
            animation: fadeIn 0.5s;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }
        
        /* Estilos responsivos */
        @media (max-width: 768px) {
            .presenter-container {
                grid-template-columns: 1fr;
            }
            
            .projection-answers {
                grid-template-columns: 1fr;
            }
            
            .projection-answer {
                height: 60px;
                font-size: 18px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>100 MEXICANOS DIJERON</h1>
            <p id="connection-status">Sistema de doble pantalla</p>
        </div>
        
        <div class="mode-selector">
            <button id="presenter-button" onclick="setMode('presenter')">Modo Presentador</button>
            <button id="projection-button" onclick="setMode('projection')">Modo Proyección</button>
            <button id="question-manager-button" onclick="setMode('question-manager')">Gestionar Preguntas</button>
        </div>
        
        <!-- Modo Presentador (Panel de Control) -->
        <div id="presenter-mode">
            <div class="presenter-container">
                <div class="game-controls">
                    <div class="question-controls">
                        <select id="question-select" onchange="selectQuestion()"></select>
                        <div class="current-question" id="presenter-question">
                            Selecciona una pregunta
                        </div>
                    </div>
                    
                    <div class="team-controls">
                        <div class="team-score">
                            <h3>Equipo 1</h3>
                            <div class="score-display" id="presenter-team1-score">0</div>
                            <div class="score-controls">
                                <button onclick="updateScore(1, -10)">-10</button>
                                <button onclick="updateScore(1, -5)">-5</button>
                                <button onclick="updateScore(1, 5)">+5</button>
                                <button onclick="updateScore(1, 10)">+10</button>
                            </div>
                        </div>
                        <div class="team-score">
                            <h3>Equipo 2</h3>
                            <div class="score-display" id="presenter-team2-score">0</div>
                            <div class="score-controls">
                                <button onclick="updateScore(2, -10)">-10</button>
                                <button onclick="updateScore(2, -5)">-5</button>
                                <button onclick="updateScore(2, 5)">+5</button>
                                <button onclick="updateScore(2, 10)">+10</button>
                            </div>
                        </div>
                    </div>
                    
                    <div class="game-actions">
                        <button onclick="resetGame()">Reiniciar Juego</button>
                        <button onclick="addStrike()">Respuesta Incorrecta</button>
                        <button onclick="resetStrikes()">Reiniciar X</button>
                    </div>
                </div>
                
                <div class="answer-list" id="presenter-answers">
                    <p>Selecciona una pregunta para ver las respuestas</p>
                </div>
            </div>
        </div>
        
        <!-- Modo Proyección (Pantalla para audiencia) -->
        <div id="projection-mode">
            <div class="projection-container">
                <div class="projection-question" id="projection-question">
                    Esperando pregunta...
                </div>
                
                <div class="projection-strikes">
                    <div class="projection-strike" id="projection-strike1">✗</div>
                    <div class="projection-strike" id="projection-strike2">✗</div>
                    <div class="projection-strike" id="projection-strike3">✗</div>
                </div>
                
                <div class="projection-answers" id="projection-answers">
                    <!-- Las respuestas se cargarán dinámicamente -->
                </div>
                
                <div class="wrong-answer" id="wrong-answer">✗</div>
                
                <div class="projection-teams">
                    <div class="projection-team">
                        <h3>Equipo 1</h3>
                        <div class="projection-score" id="projection-team1-score">0</div>
                    </div>
                    <div class="projection-team">
                        <h3>Equipo 2</h3>
                        <div class="projection-score" id="projection-team2-score">0</div>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Gestor de Preguntas -->
        <div id="question-manager">
            <h2 style="color: #ffcc00;">Administrador de Preguntas</h2>
            
            <div class="question-form">
                <label for="new-question">Nueva Pregunta:</label>
                <textarea id="new-question" placeholder="Escribe aquí la pregunta..."></textarea>
                
                <div id="answer-inputs">
                    <div class="answer-inputs">
                        <div class="answer-input-row">
                            <input type="text" placeholder="Respuesta 1" id="answer-text-1">
                            <input type="number" placeholder="Puntos" id="answer-points-1" min="1">
                        </div>
                        <div class="answer-input-row">
                            <input type="text" placeholder="Respuesta 2" id="answer-text-2">
                            <input type="number" placeholder="Puntos" id="answer-points-2" min="1">
                        </div>
                        <div class="answer-input-row">
                            <input type="text" placeholder="Respuesta 3" id="answer-text-3">
                            <input type="number" placeholder="Puntos" id="answer-points-3" min="1">
                        </div>
                        <div class="answer-input-row">
                            <input type="text" placeholder="Respuesta 4" id="answer-text-4">
                            <input type="number" placeholder="Puntos" id="answer-points-4" min="1">
                        </div>
                        <div class="answer-input-row">
                            <input type="text" placeholder="Respuesta 5" id="answer-text-5">
                            <input type="number" placeholder="Puntos" id="answer-points-5" min="1">
                        </div>
                        <div class="answer-input-row">
                            <input type="text" placeholder="Respuesta 6" id="answer-text-6">
                            <input type="number" placeholder="Puntos" id="answer-points-6" min="1">
                        </div>
                        <div class="answer-input-row">
                            <input type="text" placeholder="Respuesta 7" id="answer-text-7">
                            <input type="number" placeholder="Puntos" id="answer-points-7" min="1">
                        </div>
                        <div class="answer-input-row">
                            <input type="text" placeholder="Respuesta 8" id="answer-text-8">
                            <input type="number" placeholder="Puntos" id="answer-points-8" min="1">
                        </div>
                    </div>
                </div>
                
                <button onclick="saveQuestion()">Guardar Pregunta</button>
            </div>
            
            <div class="questions-list" id="saved-questions">
                <h3>Preguntas Guardadas:</h3>
                <!-- Lista de preguntas guardadas se cargará aquí -->
            </div>
        </div>
    </div>
    
    <audio id="buzzer">
        <source src="https://www.soundjay.com/misc/sounds/wrong-answer-sound-effect-1.mp3" type="audio/mpeg">
    </audio>
    
    <audio id="reveal">
        <source src="https://www.soundjay.com/misc/sounds/bell-ringing-05.mp3" type="audio/mpeg">
    </audio>

    <script>
        // Variables globales
        let gameState = {
            currentQuestionId: null,
            team1Score: 0,
            team2Score: 0,
            strikes: 0,
            revealedAnswers: []
        };
        
        // Preguntas predefinidas
        let questions = [
            {
                id: "q1",
                question: "Nombre los discípulos de Jesús...",
                answers: [
                    { text: "Juan", points: 55 },
                    { text: "Pedro", points: 25 },
                    { text: "Simon", points: 18 },
                    { text: "Judas", points: 12 },
                ]
            },
            {
                id: "q2",
                question: "Menciona un animal que asusta a mucha gente...",
                answers: [
                    { text: "Serpiente", points: 30 },
                    { text: "Araña", points: 25 },
                    { text: "Tiburón", points: 15 },
                    { text: "Rata/Ratón", points: 12 },
                    { text: "Cucaracha", points: 8 },
                    { text: "León", points: 7 },
                    { text: "Perro bravo", points: 3 }
                ]
            },
            {
                id: "q3",
                question: "Dime algo que la gente hace antes de dormir...",
                answers: [
                    { text: "Cepillarse los dientes", points: 32 },
                    { text: "Ver televisión", points: 22 },
                    { text: "Revisar el celular", points: 18 },
                    { text: "Leer", points: 12 },
                    { text: "Ir al baño", points: 8 },
                    { text: "Tomar agua", points: 5 },
                    { text: "Rezar", points: 3 }
                ]
            },
            {
                id: "q4",
                question: "Almunos de LIS 201",
                answers: [
                    { text: "Omar", points: 32 },
                    { text: "Mar", points: 22 },
                    { text: "Han", points: 18 },
                    { text: "Altair", points: 12 },
                    { text: "Daniel", points: 8 },
                    { text: "Jesus", points: 5 },
                    { text: "Chris", points: 3 }
                ]
            }
        ];
        
        // Inicialización
        document.addEventListener('DOMContentLoaded', function() {
            // Cargar preguntas guardadas del localStorage
            loadQuestionsFromStorage();
            
            // Inicializar la lista de preguntas
            updateQuestionSelect();
            
            // Verificar si hay un estado de juego guardado
            loadGameState();
            
            // Inicializar el modo actual
            setMode('presenter');
            
            // Configurar intervalo para sincronizar en modo proyección
            setInterval(checkForUpdates, 1000);
        });
        
        // Funciones para cambiar entre modos
        function setMode(mode) {
            // Ocultar todos los modos
            document.getElementById('presenter-mode').style.display = 'none';
            document.getElementById('projection-mode').style.display = 'none';
            document.getElementById('question-manager').style.display = 'none';
            
            // Eliminar clase activa de todos los botones
            document.getElementById('presenter-button').classList.remove('active');
            document.getElementById('projection-button').classList.remove('active');
            document.getElementById('question-manager-button').classList.remove('active');
            
            // Mostrar el modo seleccionado
            if (mode === 'presenter') {
                document.getElementById('presenter-mode').style.display = 'block';
                document.getElementById('presenter-button').classList.add('active');
            } else if (mode === 'projection') {
                document.getElementById('projection-mode').style.display = 'block';
                document.getElementById('projection-button').classList.add('active');
                initProjection();
            } else if (mode === 'question-manager') {
                document.getElementById('question-manager').style.display = 'block';
                document.getElementById('question-manager-button').classList.add('active');
            }
            
            // Guardar preferencia de modo
            localStorage.setItem('100MexicanosMode', mode);
        }
        
        // Inicializar modo proyección
        function initProjection() {
            // Cargar el estado actual del juego
            loadGameState();
            
            // Actualizar la interfaz en función del estado
            updateProjectionUI();
        }
        
        // Comprobar si hay actualizaciones (para el modo proyección)
        function checkForUpdates() {
            if (document.getElementById('projection-mode').style.display === 'block') {
                // Solo actualizar si estamos en modo proyección
                const savedState = localStorage.getItem('100MexicanosGameState');
                if (savedState) {
                    const newState = JSON.parse(savedState);
                    
                    // Comprobar si hay cambios antes de actualizar
                    if (JSON.stringify(newState) !== JSON.stringify(gameState)) {
                        gameState = newState;
                        updateProjectionUI();
                    }
                }
            }
        }
        
        // Cargar estado del juego desde el almacenamiento local
        function loadGameState() {
            const savedState = localStorage.getItem('100MexicanosGameState');
            if (savedState) {
                gameState = JSON.parse(savedState);
                
                // Actualizar la interfaz para el presentador
                updatePresenterUI();
            }
        }
        
        // Guardar estado del juego en el almacenamiento local
        function saveGameState() {
            localStorage.setItem('100MexicanosGameState', JSON.stringify(gameState));
        }
        
        // Cargar preguntas guardadas del almacenamiento local
        function loadQuestionsFromStorage() {
            const savedQuestions = localStorage.getItem('100MexicanosQuestions');
            if (savedQuestions) {
                // Combinar las preguntas predefinidas con las guardadas
                const userQuestions = JSON.parse(savedQuestions);
                questions = [...questions, ...userQuestions];
            }
        }
        
        // Actualizar el selector de preguntas
        function updateQuestionSelect() {
            const select = document.getElementById('question-select');
            select.innerHTML = '<option value="">Seleccionar pregunta...</option>';
            
            questions.forEach(q => {
                const option = document.createElement('option');
                option.value = q.id;
                option.textContent = q.question.length > 50 ? q.question.substring(0, 50) + '...' : q.question;
                select.appendChild(option);
            });
            
            // Seleccionar la pregunta actual si existe
            if (gameState.currentQuestionId) {
                select.value = gameState.currentQuestionId;
            }
            
            // Actualizar la lista de preguntas guardadas
            updateSavedQuestionsList();
        }
        
        // Actualizar la lista de preguntas guardadas
        function updateSavedQuestionsList() {
            const container = document.getElementById('saved-questions');
            // Mantener el encabezado
            container.innerHTML = '<h3>Preguntas Guardadas:</h3>';
            
            questions.forEach(q => {
                const questionDiv = document.createElement('div');
                questionDiv.className = 'saved-question';
                questionDiv.innerHTML = `
                    <div>${q.question.length > 50 ? q.question.substring(0, 50) + '...' : q.question}</div>
                    <div>
                        <button class="button-small" onclick="editQuestion('${q.id}')">Editar</button>
                        <button class="button-small button-danger" onclick="deleteQuestion('${q.id}')">Eliminar</button>
                    </div>
                `;
                container.appendChild(questionDiv);
            });
        }
        
        // Seleccionar una pregunta
        function selectQuestion() {
            const questionId = document.getElementById('question-select').value;
            if (!questionId) return;
            
            // Actualizar el estado del juego
            gameState.currentQuestionId = questionId;
            gameState.revealedAnswers = [];
            gameState.strikes = 0;
            
            // Guardar el estado
            saveGameState();
            
            // Actualizar interfaz del presentador
            updatePresenterUI();
        }
        
        // Actualizar la interfaz del presentador
        function updatePresenterUI() {
            // Actualizar puntajes
            document.getElementById('presenter-team1-score').textContent = gameState.team1Score;
            document.getElementById('presenter-team2-score').textContent = gameState.team2Score;
            
            // Actualizar pregunta actual
            if (gameState.currentQuestionId) {
                const currentQuestion = questions.find(q => q.id === gameState.currentQuestionId);
                if (currentQuestion) {
                    document.getElementById('presenter-question').textContent = currentQuestion.question;
                    
                    // Actualizar lista de respuestas
                    const answersContainer = document.getElementById('presenter-answers');
                    answersContainer.innerHTML = '';
                    
                    currentQuestion.answers.forEach((answer, index) => {
                        const isRevealed = gameState.revealedAnswers.includes(index);
                        
                        const answerDiv = document.createElement('div');
                        answerDiv.className = `admin-answer ${isRevealed ? 'revealed' : ''}`;
                        
                        answerDiv.innerHTML = `
                            <div class="answer-number">${index + 1}</div>
                            <div class="answer-text">${answer.text}</div>
                            <div class="answer-points">${answer.points}</div>
                            <button class="reveal-btn" onclick="revealAnswer(${index})" ${isRevealed ? 'disabled' : ''}>
                                ${isRevealed ? 'Revelada' : 'Revelar'}
                            </button>
                        `;
                        
                        answersContainer.appendChild(answerDiv);
                    });
                }
            } else {
                document.getElementById('presenter-question').textContent = 'Selecciona una pregunta';
                document.getElementById('presenter-answers').innerHTML = '<p>Selecciona una pregunta para ver las respuestas</p>';
            }
            
            // Seleccionar la pregunta actual en el selector
            if (gameState.currentQuestionId) {
                document.getElementById('question-select').value = gameState.currentQuestionId;
            }
        }

function updateProjectionUI() {
    // Actualizar puntajes
    document.getElementById('projection-team1-score').textContent = gameState.team1Score;
    document.getElementById('projection-team2-score').textContent = gameState.team2Score;
    
    // Actualizar X (strikes)
    document.getElementById('projection-strike1').classList.toggle('active', gameState.strikes >= 1);
    document.getElementById('projection-strike2').classList.toggle('active', gameState.strikes >= 2);
    document.getElementById('projection-strike3').classList.toggle('active', gameState.strikes >= 3);
    
    // Actualizar pregunta actual
    if (gameState.currentQuestionId) {
        const currentQuestion = questions.find(q => q.id === gameState.currentQuestionId);
        if (currentQuestion) {
            document.getElementById('projection-question').textContent = currentQuestion.question;
            
            // Actualizar lista de respuestas
            const answersContainer = document.getElementById('projection-answers');
            answersContainer.innerHTML = '';
            
            currentQuestion.answers.forEach((answer, index) => {
                const isRevealed = gameState.revealedAnswers.includes(index);
                
                const answerDiv = document.createElement('div');
                answerDiv.className = `projection-answer ${isRevealed ? '' : 'hidden'}`;
                
                answerDiv.innerHTML = `
                    <div class="projection-answer-number">${index + 1}</div>
                    <div class="projection-answer-text">${answer.text}</div>
                    <div class="projection-answer-points">${answer.points}</div>
                `;
                
                answersContainer.appendChild(answerDiv);
            });
        }
    } else {
        document.getElementById('projection-question').textContent = 'Esperando pregunta...';
        document.getElementById('projection-answers').innerHTML = '';
    }
}

// Revelar una respuesta
function revealAnswer(index) {
    if (!gameState.revealedAnswers.includes(index)) {
        // Reproducir sonido de revelación
        document.getElementById('reveal').play();
        
        // Añadir a respuestas reveladas
        gameState.revealedAnswers.push(index);
        
        // Guardar estado
        saveGameState();
        
        // Actualizar interfaces
        updatePresenterUI();
    }
}

// Añadir un strike (X)
function addStrike() {
    if (gameState.strikes < 3) {
        // Reproducir sonido de respuesta incorrecta
        document.getElementById('buzzer').play();
        
        // Mostrar animación de X grande
        const wrongAnswer = document.getElementById('wrong-answer');
        wrongAnswer.style.display = 'block';
        setTimeout(() => {
            wrongAnswer.style.display = 'none';
        }, 1000);
        
        // Incrementar contador de strikes
        gameState.strikes++;
        
        // Guardar estado
        saveGameState();
        
        // Actualizar interfaces
        updatePresenterUI();
    }
}

// Resetear strikes
function resetStrikes() {
    gameState.strikes = 0;
    saveGameState();
    updatePresenterUI();
}

// Actualizar puntuación de equipo
function updateScore(team, points) {
    if (team === 1) {
        gameState.team1Score += points;
        // Evitar puntuación negativa
        if (gameState.team1Score < 0) gameState.team1Score = 0;
    } else {
        gameState.team2Score += points;
        // Evitar puntuación negativa
        if (gameState.team2Score < 0) gameState.team2Score = 0;
    }
    
    // Guardar estado
    saveGameState();
    
    // Actualizar interfaces
    updatePresenterUI();
}

// Reiniciar juego
function resetGame() {
    if (confirm('¿Estás seguro de que quieres reiniciar el juego? Se perderán todos los puntos.')) {
        gameState = {
            currentQuestionId: gameState.currentQuestionId,  // Mantener la pregunta actual
            team1Score: 0,
            team2Score: 0,
            strikes: 0,
            revealedAnswers: []
        };
        
        // Guardar estado
        saveGameState();
        
        // Actualizar interfaces
        updatePresenterUI();
    }
}

// Guardar una nueva pregunta
function saveQuestion() {
    const questionText = document.getElementById('new-question').value.trim();
    if (!questionText) {
        alert('Por favor, escribe una pregunta');
        return;
    }
    
    // Recopilar respuestas
    const answers = [];
    for (let i = 1; i <= 8; i++) {
        const answerText = document.getElementById(`answer-text-${i}`).value.trim();
        const pointsValue = document.getElementById(`answer-points-${i}`).value;
        
        if (answerText && pointsValue) {
            answers.push({
                text: answerText,
                points: parseInt(pointsValue, 10)
            });
        }
    }
    
    if (answers.length === 0) {
        alert('Por favor, añade al menos una respuesta');
        return;
    }
    
    // Crear ID único para la pregunta
    const questionId = 'q' + Date.now();
    
    // Añadir la nueva pregunta
    const newQuestion = {
        id: questionId,
        question: questionText,
        answers: answers
    };
    
    // Añadir a la lista de preguntas
    questions.push(newQuestion);
    
    // Guardar en localStorage (solo preguntas del usuario)
    const userQuestions = questions.filter(q => !q.id.startsWith('q1') && !q.id.startsWith('q2') && !q.id.startsWith('q3'));
    localStorage.setItem('100MexicanosQuestions', JSON.stringify(userQuestions));
    
    // Actualizar interfaces
    updateQuestionSelect();
    
    // Limpiar el formulario
    document.getElementById('new-question').value = '';
    for (let i = 1; i <= 8; i++) {
        document.getElementById(`answer-text-${i}`).value = '';
        document.getElementById(`answer-points-${i}`).value = '';
    }
    
    alert('Pregunta guardada correctamente');
}

// Editar una pregunta existente
function editQuestion(questionId) {
    const question = questions.find(q => q.id === questionId);
    if (!question) return;
    
    // Rellenar el formulario con los datos de la pregunta
    document.getElementById('new-question').value = question.question;
    
    // Rellenar las respuestas
    for (let i = 1; i <= 8; i++) {
        if (i <= question.answers.length) {
            document.getElementById(`answer-text-${i}`).value = question.answers[i-1].text;
            document.getElementById(`answer-points-${i}`).value = question.answers[i-1].points;
        } else {
            document.getElementById(`answer-text-${i}`).value = '';
            document.getElementById(`answer-points-${i}`).value = '';
        }
    }
    
    // Cambiar al modo de gestión de preguntas
    setMode('question-manager');
    
    // Eliminar la pregunta original (se volverá a añadir al guardar)
    questions = questions.filter(q => q.id !== questionId);
    
    // Actualizar interfaces
    updateQuestionSelect();
    
    alert('Ahora puedes editar la pregunta y guardarla como una nueva pregunta');
}

// Eliminar una pregunta
function deleteQuestion(questionId) {
    if (confirm('¿Estás seguro de que quieres eliminar esta pregunta?')) {
        // Eliminar la pregunta
        questions = questions.filter(q => q.id !== questionId);
        
        // Si era la pregunta actual, resetear
        if (gameState.currentQuestionId === questionId) {
            gameState.currentQuestionId = null;
            gameState.revealedAnswers = [];
            gameState.strikes = 0;
            saveGameState();
        }
        
        // Guardar en localStorage (solo preguntas del usuario)
        const userQuestions = questions.filter(q => !q.id.startsWith('q1') && !q.id.startsWith('q2') && !q.id.startsWith('q3'));
        localStorage.setItem('100MexicanosQuestions', JSON.stringify(userQuestions));
        
        // Actualizar interfaces
        updateQuestionSelect();
        updatePresenterUI();
        
        alert('Pregunta eliminada correctamente');
    }
}

// Función para inicializar el juego
function initGame() {
    loadQuestionsFromStorage();
    updateQuestionSelect();
    loadGameState();
    
    // Establecer el modo según preferencia guardada
    const savedMode = localStorage.getItem('100MexicanosMode');
    if (savedMode) {
        setMode(savedMode);
    } else {
        setMode('presenter');
    }
}

// Iniciar el juego al cargar la página
window.onload = initGame;
    </script>
</body>
</html>